1.c++虚构函数

在C++中，构造函数不能是虚函数，这主要是由于以下几个原因：

对象的构造过程：当一个对象被创建时，构造函数的主要任务是初始化对象的状态。在对象构造期间，其类型尚未确定，因此不可能进行虚函数的动态绑定。

继承与多态性：如果构造函数是虚函数，调用它时就无法确定应该调用哪个类的构造函数。这会导致不明确的行为，因为基类构造函数会在派生类构造函数之前被调用。

资源管理：构造函数的目的在于分配和初始化对象所需的资源。如果构造函数可以是虚的，会导致资源管理变得复杂，因为在构造期间并没有完整的对象实例。

对象生命周期：在对象的生命周期内，虚函数表的设置是在对象完全构造后进行的。因此，在构造函数中调用虚函数会导致潜在的未定义行为，因为在这个阶段，虚函数表还没有被正确设置。

因此，为了保持对象构造过程的明确性和一致性，C++规定构造函数不能是虚函数。

2.构造函数调用虚函数

在构造函数中调用虚函数不会导致编译错误，但确实不应期望它会按预期工作，因为此时动态绑定不会发挥作用，只会调用基类的版本。

构造函数中的虚函数
在构造函数中调用虚函数会导致调用基类的实现，而不是派生类的实现，因为对象还处于构造阶段，派生类部分尚未初始化。这可能导致不符合预期的行为。
析构函数中的虚函数
在析构函数中调用虚函数是可以的，并且此时会根据对象的实际类型调用相应的派生类的版本。这是因为对象已经完全构造，直到析构函数被调用时，整个对象的生命周期已完成。
总结
构造函数中调用虚函数应避免，因为不会执行派生类的实现。
析构函数中调用虚函数是有效的，会按预期工作。
